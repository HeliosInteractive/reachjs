/*Reach Client v2.0.1*/
!function(a,b){"use strict";function c(a){function b(b,c){return b.push(c+"="+encodeURIComponent(a[c])),b}return a?"string"==typeof a?"?"+a:"?"+Object.keys(a).reduce(b,[]).join("&"):""}function d(a){function b(a){if(a){var b=a.split(":");c[b[0]]=b[1].trim()}}if(!a)return a;var c={};return a.split("\r\n").forEach(b),c}function e(a){var b=require("form-data"),c=new b;return c.append("file",a.data,{filename:a.path,contentType:a.type,basename:!1}),c}function f(b){if("POST"!==b.method&&"PUT"!==b.method)return b;if(b.headers&&"multipart/form-data"===b.headers["Content-Type"])return b;var c=a.merge(!0,b);return delete c.headers,delete c.uri,delete c.data,delete c.method,b.data=c,b}function g(a,b){b.where&&(a.where=b.where),b.limit&&(a.limit=b.limit),b.include&&(a.include=b.include),b.skip&&(a.skip=b.skip),b.fields&&(a.fields=b.fields),b.order&&(a.order=b.order);var c=!1;if(Object.keys(a).length>0)try{c=JSON.stringify(a),c="filter="+c}catch(d){}return c}function h(a){return function(b,c,d){return"function"==typeof c&&(d=c,c={}),"object"==typeof b?b.method=a:c.method=a,o(b,c,d)}}function i(a,b,c){b[0]?b=b.map(function(b){return b.path=a+b.name,b}):b.path=a+b.name,"/"===a.substr(0,1)&&(a=a.substr(1)),o("containers/reachdata/upload",{method:"POST",headers:{"Content-Type":"multipart/form-data"},data:b},c)}var j=function(a,b,e){function f(a){e(a)}function g(a){var b={body:a.target.response,status:a.target.status,url:a.target.responseURL,headers:d(h.oReq.getAllResponseHeaders())};try{var c=JSON.parse(a.target.response);b.body=c}catch(f){}e(null,b)}var h=this;h.oReq=new XMLHttpRequest,a+=c(b.qs),h.oReq.addEventListener("load",g),h.oReq.addEventListener("error",f),h.oReq.open(b.method&&b.method.toUpperCase()||"GET",a,!0);var i=null;b.data&&(b.headers&&"multipart/form-data"===b.headers["Content-Type"]?(i=new FormData,i.append("file",b.data.data,b.data.path),delete b.headers["Content-Type"]):i=JSON.stringify(b.data)),b.headers&&"object"==typeof b.headers&&Object.keys(b.headers).forEach(h.setHeaders.bind(h,b.headers)),h.oReq.send(i)};j.prototype.setHeaders=function(a,b){this.oReq.setRequestHeader(b,a[b])};var k=function(a,b,d){function f(b){function c(a){f.body+=a}function e(){try{var a=JSON.parse(f.body);f.body=a}catch(b){}d(null,f)}var f={body:"",status:b.statusCode,url:a,headers:b.headers};b.setEncoding("utf8"),b.on("data",c),b.on("end",e)}function g(a){d(a)}var h=require("http"),i=require("url");a+=c(b.qs);var j=i.parse(a,!0,!0),k={host:j.hostname,protocol:j.protocol,port:j.port,path:j.path,headers:b.headers,method:b.method},l=!1;b.headers&&"multipart/form-data"===b.headers["Content-Type"]&&(l=e(b.data),k.headers["Content-Type"]=l.getHeaders()["content-type"]);var m=h.request(k,f).on("error",g);l?l.pipe(m):b.data&&m.write(JSON.stringify(b.data)),m.end()};"undefined"!=typeof module&&module.exports?a.request=module.exports=k:a.request=j;var l,m,n,o=function(a,b,c){if(!n)throw new Error("set the url for reach with reachjs.setUrl('')");if("undefined"==typeof a)throw new Error("undefined is not a valid uri or options object.");if(!o.key)throw new Error("reach.key is required");"function"==typeof b&&(c=b),"object"==typeof b?b.uri=a:b="string"==typeof a?{uri:a}:a,"/"===b.uri.substr(0,1)&&(b.uri=b.uri.substr(1)),b=f(b),a=n+b.uri,delete b.uri;var d=g({},b);return d&&(b.qs=d),!b.headers&&(b.headers={}),b.headers["X-Helios-ID"]=o.key,b.headers["Content-Type"]||(b.headers["Content-Type"]="application/json"),new l(a,b,c)};"undefined"!=typeof module&&module.exports?module.exports=o:b.reach=a.reach=o,l=a&&a.request?a.request:require("./lib/request"),m=a&&a.image?a.image:require("./lib/image"),a&&a.merge||(a.merge=require("./lib/merge")),o.key=null,o.get=h("GET"),o.post=h("POST"),o.put=h("PUT"),o.del=h("DELETE"),o.request=l,o.image=m,o.upload=i,o.development=function(){console.error("reach.development is no longer supported. Set the url explicitly with reach.setUrl()")},o.setUrl=function(a){"/"!==a.substr(-1)&&(a+="/"),"api/"!==a.substr(-4)&&(a+="api/"),a&&(n=a)},b["true"]=a}({},function(){return this}());