/*Reach Client v0.9.0*/
!function(a,b){"use strict";function c(a){function b(b,c){return b.push(c+"="+encodeURIComponent(a[c])),b}return a?"string"==typeof a?"?"+a:"?"+Object.keys(a).reduce(b,[]).join("&"):""}function d(a){function b(a){if(a){var b=a.split(":");c[b[0]]=b[1].trim()}}if(!a)return a;var c={};return a.split("\r\n").forEach(b),c}function e(a){var b="---------------------------"+Date.now().toString(16),c=[];if(a[0])for(var d=0;d<a.length;d++)c[d]='Content-Disposition: form-data; name="file"; filename="'+a[d].path+'"\r\nContent-Type: '+a[d].type+"\r\n\r\n",c[d]+=a[d].data+"\r\n";else c=['Content-Disposition: form-data; name="file"; filename="'+a.path+'"\r\nContent-Type: '+a.type+"\r\n\r\n"+a.data+"\r\n"];return{boundary:b,body:"--"+b+"\r\n"+c.join("--"+b+"\r\n")+"--"+b+"--\r\n"}}function f(b){if("POST"!==b.method&&"PUT"!==b.method)return b;if(b.headers&&"multipart/form-data"===b.headers["Content-Type"])return b;var c=a.merge(!0,b);return delete c.headers,delete c.uri,delete c.data,delete c.method,b.data=c,b}function g(a,b){b.where&&(a.where=b.where),b.limit&&(a.limit=b.limit),b.include&&(a.include=b.include),b.skip&&(a.skip=b.skip),b.fields&&(a.fields=b.fields);var c=!1;if(Object.keys(a).length>0)try{c=JSON.stringify(a),c="filter="+c}catch(d){}return c}function h(a){return function(b,c,d){return"object"==typeof c?c.method=a:"object"==typeof b&&(b.method=a),r(b,c,d)}}function i(a,b,c){b[0]?b=b.map(function(b){return b.path=a+b.name,b}):b.path=a+b.name,"/"===a.substr(0,1)&&(a=a.substr(1)),r("containers/reachdata/upload",{method:"POST",headers:{"Content-Type":"multipart/form-data"},data:b},c)}var j=function(a,b,f){function g(a){var b={body:a.target.response,status:a.target.status,url:a.target.responseURL,headers:d(h.oReq.getAllResponseHeaders())};try{var c=JSON.parse(a.target.response);b.body=c}catch(e){}f(null,b)}var h=this;h.oReq=new XMLHttpRequest,a+=c(b.qs),h.oReq.addEventListener("load",g),h.oReq.open(b.method&&b.method.toUpperCase()||"GET",a,!0);var i=null;if(b.data)if(b.headers&&"multipart/form-data"===b.headers["Content-Type"]){var j=e(b.data);b.headers["Content-Type"]+=", boundary="+j.boundary,i=j.body}else i=JSON.stringify(b.data);b.headers&&"object"==typeof b.headers&&Object.keys(b.headers).forEach(h.setHeaders.bind(h,b.headers)),h.oReq.send(i)};j.prototype.setHeaders=function(a,b){this.oReq.setRequestHeader(b,a[b])};var k=function(a,b,d){function e(b){function c(a){f.body+=a}function e(){try{var a=JSON.parse(f.body);f.body=a}catch(b){}d(null,f)}var f={body:"",status:b.statusCode,url:a,headers:b.headers};b.setEncoding("utf8"),b.on("data",c),b.on("end",e)}function f(a){d(a)}var g=require("http"),h=require("url");a+=c(b.qs);var i=h.parse(a,!0,!0),j={host:i.host,protocol:i.protocol,path:i.path,headers:b.headers,method:b.method},k=g.request(j,e).on("error",f);b.data&&k.write(JSON.stringify(b.data)),k.end()};"undefined"!=typeof module&&module.exports?a.request=module.exports=k:a.request=j;var l,m,n="http://local.reach.com/api/",o="http://reachstadiums.herokuapp.com/api/",p=!1,q=o,r=function(a,b,c){if("undefined"==typeof a)throw new Error("undefined is not a valid uri or options object.");if(!r.key)throw new Error("reach.key is required");"function"==typeof b&&(c=b),"object"==typeof b?b.uri=a:b="string"==typeof a?{uri:a}:a,"/"===b.uri.substr(0,1)&&(b.uri=b.uri.substr(1)),b=f(b),a=q+b.uri,delete b.uri;var d=g({},b);return d&&(b.qs=d),!b.headers&&(b.headers={}),b.headers["X-Helios-ID"]=r.key,b.headers["Content-Type"]||(b.headers["Content-Type"]="application/json"),new l(a,b,c)};"undefined"!=typeof module&&module.exports?module.exports=r:b.reach=a.reach=r,l=a&&a.request?a.request:require("./lib/request"),m=a&&a.image?a.image:require("./lib/image"),a&&a.merge||(a.merge=require("./lib/merge")),r.development=function(a){return a?(p=!!a,void(q=p?n:o)):p},r.key=null,r.get=h("GET"),r.post=h("POST"),r.put=h("PUT"),r.del=h("DELETE"),r.request=l,r.image=m,r.upload=i,b["true"]=a}({},function(){return this}());